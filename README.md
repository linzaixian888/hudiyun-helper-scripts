## 狐蒂云自动抢购 - 使用说明

- 不要在活动页面等，要到具体商品页面等，所以该项目才会有俩个脚本。
- 香港pid1859
- https://www.szhdy.com/cart?action=configureproduct&pid=1859
- 其他：
- 1850 12+2香港25区 2H系列
- 1851 12+2香港25区 4H系列
- 1852 12+2宁波6区-4H系列
- 1853 三周年 香港9区16H16G
- 1854 三周年 美国2区16H16G
- 1855 三周年 广州BGP16H16G
- 1856 三周年 宁波7区16H16G
- 1857 三周年 深圳2区16H16G
- 1858 三周年 香港26区2H2G
- 1859 三周年 香港云服务器16H16G
- 1860 三周年 美国云服务器16H16G
- 1861 三周年 国内云服务器16H16G
- 1862 潮州12区8H8G(YJ)
- 1863 潮州12区16H16G(YJ)
- 1864 宁波12区-4H系列
- 1865 宁波12区-8H系列
- 1866 宁波12区-16H系列
- 1867 宁波12区-32H系列
- 1868 佛山1区-4H系列
- 1869 佛山1区-8H系列
- 1870 佛山1区-16H系列
- 1871 佛山1区-32H系列
- 1872 佛山2区-4H系列
- 1873 佛山2区-8H系列
- 1874 佛山2区-16H系列
- 1875 佛山2区-32H系列
- 1876 香港34区|三网直连| 2H系列
- 1877 香港34区|三网直连| 4H系列
- 1878 香港34区|三网直连| 8H系列
- 1879 香港34区|三网直连| 16H系列
- 1880 香港34区|三网直连| 32H系列
- 1881 香港35区|精品网络| 4H系列
- 1882 香港35区|精品网络| 8H系列
- 1883 香港35区|精品网络| 16H系列
- 1884 香港35区|精品网络| 32H系列
- 1885 佛山1区8H8G(YJ)
- 1886 佛山1区16H16G(YJ)
- 1887 香港34区 16H16G(YJ)
- 1888 香港34区 8H8G(YJ)
- 1889 香港1区16H16G(YJ)
- 1890 佛山2区8H8G(YJ)
- 11.01更新


### 检测模式

- 全天候检测（all_day）
  - 进入或切换到该模式后，开始时间自动设为当前时间，结束时间输入被隐藏。
  - 0-24 小时持续检测配置的商品 ID；发现可购立即点击购买。
  - 连续未发现商品会累计失败次数，达到阈值（默认 5 次）后自动刷新页面再继续。
  - 面板状态显示“全天候(运行中)”，倒计时区域固定提示“全天候：0-24点”。
  - 进入支付页自动暂停；进入购物车页自动勾选并提交，提交后自动暂停。

- 平时三时间段（three_periods）
  - 每天在 3 个时间窗口内运行：7:00-9:00、13:00-14:00、17:00-19:00。
  - 窗口外：面板显示“等待三时间段”，倒计时显示距下个窗口开始的时间。
  - 窗口内：状态“抢购中(三段)”，倒计时显示距本窗口结束的时间；执行检测与自动下单。
  - 连续未发现商品达到阈值（默认 5 次）会自动刷新页面；一个窗口结束会自动等待下个窗口。

### 页面识别与通用检测

- 特殊页面
  - 支付页：自动暂停（不执行操作）。
  - 购物车页：自动勾选支付/条款并提交订单，提交后自动暂停。
  - 保护页（如配置页）：不刷新，仅尝试必要操作。

- 通用检测（不依赖特定 URL）
  - 只要页面存在“商品卡 + 按钮”，就会尝试检测与点击：
    - 直接匹配按钮链接中的 pid/gid：`.form-footer-butt[href*="pid=ID"], a[href*="gid=ID"]`。
    - 兼容容器属性：`[data-id="ID"]` 或 `[data-gid="ID"]` 内的按钮。

### 配置与存储

- 所有配置与运行状态持久化在浏览器 localStorage：
  - 配置：`hudiyun_config`
  - 运行状态（开始/暂停）：`hudiyun_running`
- 模式为圆点单选，切换即自动保存；其它配置点击“保存”写入，并在非保护页自动刷新生效。

### 关键参数

- 检测间隔（ms）：默认 800，可在面板调整。
- 自动刷新阈值（次）：默认 5。以“检测次数”计数，不是秒数。
  - 例：阈值=5、间隔=1000ms 时，第一次检测在 t=0 触发计数，所以约在 ~4.5s 左右刷新（包含一次刷新延时）。

### 常见问题

- 看不到自动检测/点击？
  - 打开控制台检查是否存在以下元素之一：
    - `document.querySelector('.form-footer-butt[href*="pid=目标ID"]')`
    - `document.querySelector('[data-id="目标ID"] .form-footer-butt')`
    - `document.querySelector('a[href*="gid=目标ID"]')`


- 有时候购物车会产生重复订单，这时需要人工手动删除，直到剩下一个，然后直接进到支付页开脚本等着，脚本会帮你重复提交

---

## 狐蒂云识别商品页 - 使用说明

### 功能简介

自动在指定 PID 范围内扫描狐蒂云商品页，识别有效的商品配置页面，并记录成功的商品 ID。

### 使用方法

1. **设置扫描范围**
   - 起始 PID：要扫描的第一个商品 ID
   - 结束 PID：要扫描的最后一个商品 ID
   - 检查间隔：每个页面检查的间隔时间（毫秒）

2. **开始扫描**
   - 点击"开始"按钮开始自动扫描
   - 脚本会自动跳转到每个 PID 的页面进行检查
   - 识别成功的 PID 会自动记录并显示在列表中

3. **查看结果**
   - 成功的 ID 会实时显示在面板中
   - 点击"复制"按钮可复制所有成功 ID（逗号分隔）
   - 点击"清空"按钮可清除所有记录

### 识别逻辑

脚本通过检测以下元素判断页面是否为有效的商品页：

**成功的特征：**
- 包含产品名称或标题
- 有"周期"选择按钮组
- 有配置选择器（CPU、内存等）
- 有"加入购物车"按钮

**失败的特征：**
- 显示多个地区导航菜单
- 页面为空或显示错误信息

### 配置与存储

- 配置存储在 `localStorage`: `hudiyun_scanner_config`
- 成功 ID 列表存储在 `localStorage`: `hudiyun_scanner_success`
- 修改配置后自动保存
- 脚本关闭后重新打开会保留之前的成功记录


